# Binary System V3.1 Deployment and Integration Guide

## Contract Updates Summary

The BinariSystemV3.1.sol contract has been updated with the following specifications:

### 1. Distribution Changes (100%)
- **70% Smart Contract**: Remains in contract for operations
- **1% Steven**: Wallet distribution
- **5% Wallet 1**: External wallet distribution  
- **24% Wallet 2**: External wallet distribution

### 2. Compensation Plan Updates
- **50% VD (Venta Directa)**: Direct sales commission
- **20% Binary**: Binary system rewards
- **Matching 5 levels**: 0.8% for each level (5 levels total)

### 3. Withdrawal Fee
- **8% Fee**: Applied on all withdrawals

### 4. Global Return
- **300% Global**: Each package generates 300% total return

## Technical Changes Made

### Contract Modifications
1. **Updated `valor` array**: `[1, 5, 24]` for wallet distributions
2. **Updated `porcientos`**: `[500]` for 50% direct sales (500/10 = 50%)
3. **Updated `porcentPuntosBinario`**: `200` for 20% binary (200/10 = 20%)
4. **Updated `porcientosSalida`**: `[8, 8, 8, 8, 8]` for 0.8% per level
5. **Updated `valorFee`**: `[80, 80, 80]` for 8% withdrawal fee
6. **Added `tiempo()` function**: Returns configurable time period
7. **Added `dias` variable**: Configurable days for contract duration
8. **Fixed compilation errors**: Resolved undefined variables

### Frontend Integration
1. **Updated ABI files**: 
   - `frontend/src/abi/binary.js` - Main contract ABI
   - `frontend/src/abi/binary_proxy.js` - Proxy contract ABI
2. **Contract compatibility**: Frontend components are compatible with new contract functions

## Deployment Steps

### 1. Contract Compilation
```bash
# Install Solidity compiler (already done)
npm install -g solc

# Compile contract (already done)
solcjs --bin --abi contracts/BinariSystemV3.1.sol
```

### 2. Contract Deployment
The contract needs to be deployed to the blockchain with the following steps:

1. **Deploy the main contract** using the generated bytecode
2. **Initialize the contract** by calling `inicializar()` function
3. **Update frontend configuration** with new contract address

### 3. Frontend Configuration Update
Update `frontend/src/cons.js` with the new contract address:

```javascript
let SC_Proxy = "NEW_CONTRACT_ADDRESS_HERE"; // Replace with deployed contract address
```

### 4. Environment Setup
Ensure the following environment variables are set:
- `REACT_APP_URL_API`: API endpoint for backend services
- `REACT_APP_URL_API_2`: Testnet API endpoint (if using testnet)

## Contract Functions Integration

### Key Functions Available in Frontend:

#### User Registration
- `registro(sponsor, hand)`: Register new user
- `asignFreeMembership(user, sponsor, hand)`: Admin function for free registration

#### Investment Functions
- `buyPlan(value)`: Purchase investment plan
- `asignarPlan(user, plan, depago)`: Admin function to assign plans

#### Withdrawal Functions
- `withdraw()`: Withdraw available funds
- `newRecompensa()`: Claim range rewards

#### View Functions
- `investors(address)`: Get investor information
- `verDepositos(user)`: View user deposits
- `withdrawable(user)`: Check withdrawable amount
- `ventaDirecta(user)`: Direct sales earnings
- `binario(user)`: Binary earnings
- `matchingBonus(user)`: Matching bonus earnings

#### Admin Functions
- `controlWitdrawl(bool)`: Enable/disable withdrawals
- `setPlan(value)`: Set plan price
- `setDias(dias)`: Set contract duration
- `setRetorno(percent)`: Set return percentage

## Error Handling

The frontend includes comprehensive error handling for:
- **MetaMask connection issues**
- **Network switching**
- **Transaction failures**
- **Contract call errors**
- **Invalid wallet addresses**

## Testing Checklist

### Pre-Deployment Testing
- [ ] Contract compiles without errors
- [ ] All functions work as expected
- [ ] Percentage calculations are correct
- [ ] Fee distributions work properly

### Post-Deployment Testing
- [ ] Frontend connects to new contract
- [ ] User registration works
- [ ] Investment purchases work
- [ ] Withdrawal system functions
- [ ] Admin functions accessible
- [ ] Balance displays correctly
- [ ] Transaction confirmations work

## Security Considerations

1. **Contract Verification**: Verify contract source code on blockchain explorer
2. **Admin Access**: Ensure proper admin level controls
3. **Fee Calculations**: Verify all percentage calculations
4. **Withdrawal Limits**: Test minimum/maximum withdrawal limits
5. **Time Locks**: Verify withdrawal timer functionality

## Troubleshooting

### Common Issues:
1. **ABI Mismatch**: Ensure frontend ABI matches deployed contract
2. **Network Issues**: Verify correct chain ID configuration
3. **Gas Estimation**: Some functions may require higher gas limits
4. **Precision Errors**: Use BigNumber for all financial calculations

### Debug Steps:
1. Check browser console for errors
2. Verify MetaMask network settings
3. Confirm contract address is correct
4. Test with small amounts first

## Support

For technical support or deployment assistance:
- Review contract source code in `contracts/BinariSystemV3.1.sol`
- Check frontend integration in `frontend/src/components/`
- Verify configuration in `frontend/src/cons.js`

## Version Information
- **Contract Version**: 3.1.0
- **Solidity Version**: >=0.8.0 <0.9.0
- **Frontend Framework**: React.js
- **Web3 Library**: Web3.js